This project offers a simple database for terminological storage, and illustrates the use of [PostgreSQL textsearch-dictionaries](http://www.postgresql.org/docs/9.1/static/textsearch-dictionaries.html), [dict-xsyn](http://www.postgresql.org/docs/current/static/dict-xsyn.html), [metaphone and levenshtein](http://www.postgresql.org/docs/current/static/fuzzystrmatch.html), in a context of terminological applications (search and admin).  Is supposed that, when all logic is at the (SQL) database, the algorithms can be simpler and faster.

## Objetive ##
To present *reference database structure* for "terminology by demand", and offer [requirements](https://en.wikipedia.org/wiki/Software_requirements_specification) and implemantation of a *framework* for manage, search and resolve controled terminologies. Illustrates also a full-SQL-database implementation.

## PREPARE ##
```
cd sql-term
php src/prepare.php
```
The default is ti prepare `term1`, edit *$modeVers* (at `prepare.php`) to prepare term0 Project.

## Examples and case uses
... As webservice or SQL direct quering... See reference for testing data, [Wayta](http://wayta.scielo.org/).

## Modeling ##

The *Term* table is so simple: each term, canonic or not, is a row in the main table. A secondary table for namespaces, *ns*, split terms in "base" group (theme, corpus or project) and  its "auxiliary" groups, for translations (one namespace for each language) and other dependent namespaces.

UML class diagram of [ini.sql](src/ini.sql):

![uml class diagram](http://yuml.me/fe36a8da)

generated by [yuml.me/diagram](http://yuml.me/diagram/scruffy/class/draw)  from

```
 [ns|nsid;label;lang;is_base;jinfo]
 [Term|id;term;is_canonic;jinfo]
 [Term{bg:green}]^-[term_canonic],  [Term]^-[term_synonym]
 [ns{bg:green}]^-[ns_base],  [ns]^-[ns_aux]

 [ns_base]1---*[ns_aux]
 [term_canonic]1---*[term_synonym]
 [ns]1---1..*[Term]
```

### Conventions ###
The  public functions runs in a set of namespaces defined by the base-namespace, never in "all namespaces".
Some functions can be config to target a specific namespace or  to specific languages.

For each namespace the "canonic term" concept can change, from standardized to "most-popular" statistics. Semantic conflict or compromise between canonic term and its synonymous, are both valid, semantic analyses is out of scope of this project. The is_cult flag is an option to 

For searching and resolving, use a base-namespace as target and adopt its mask with `term1.get_basemask(label)` for all searches and resolutions. To offer more specific language-target options in the interface, use `term1.get_baselangs(label)`. 
 
3) futuro: lexema também pode ter seu metaphone 
... restrição de busca por LANG vem do ns_base, mas pode ser uma máscara-ou ... Ver caso Caboverde onde há sempre duas linguas suspeitas, a do país de origem e a do artigo. O usuário pode indicar ordem de busca por línguas, e depois comprar o score... No caso de construção de regex,  

1) getns_base = somente os namespaces-base, como opção de busca
 ... 






## Populating with other data
... CSV import , SQL import ... Namespaces... 

## Fast Guide

Use of SQL functions. For function description, see 

* `term1.search2c()`


## NOTES

* [Using metaphone as lexeme](http://stackoverflow.com/questions/4001579/postgresql-full-text-search-randomly-dropping-lexemes).

* PostreSQL guide, 
** [Text search dictionaries](http://www.postgresql.org/docs/9.1/static/textsearch-dictionaries.html#TEXTSEARCH-THESAURUS)
** [runtime-config-client](http://www.postgresql.org/docs/current/static/runtime-config-client.html#GUC-DEFAULT-TEXT-SEARCH-CONFIG)

* Testing dataset: [Wayta site](http://wayta.scielo.org/) and [Wayta dataset](https://github.com/scieloorg/wayta).

### Context and concepts

* ... [Controlled terminologies](https://www.wikidata.org/wiki/Q1469824) ...

* ... lexemes ...  this project is illustring use of [português brasileiro](https://www.wikidata.org/wiki/Q750553)... 

* XML and precise markup of terms: terms into [JATS](https://en.wikipedia.org/wiki/Journal_Article_Tag_Suite), [AKN](http://www.akomantoso.org/) or [LexML](http://projeto.lexml.gov.br/documentacao/Parte-3-XML-Schema.pdf) documents... Each document must use a public standard ID, as  [DOI](https://www.wikidata.org/wiki/Q25670) or [URN Lex](https://en.wikipedia.org/wiki/Lex_(URN)).

* [MADLib filosofy](http://doc.madlib.net/latest/), an "open-source library for scalable in-database analytics", as we need here. See also simple lib examples at [pgxn.org](http://pgxn.org/).

### Future implementations

The automatic choice of language needs "dynamic *tsquery*" and in-loop change of *regconfig*, so, some caching or some fast ID2regconfig convertion.


